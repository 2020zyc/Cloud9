<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>Cloud9: A MapReduce Library for Hadoop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" />
</head>

<body>

<center><table width="80%"><tbody><tr><td align="left">

<h2>Cloud<sup><small>9</small></sup>: Exercises: Inverted index construction</h2>

<p>by Jimmy Lin</p>

<p>
<small>(Page first created: 15 Aug 2008; last updated:
<script language="JavaScript" type="text/javascript">
<!--
var LastUpdated = "$Date$";
LastUpdated = LastUpdated.substring(LastUpdated.length-14, LastUpdated.length-3);
document.writeln (LastUpdated+")");
-->
</script>
</small>
</p>

<div class="main">

<p>In this exercise, you'll be creating an <i>inverted index</i>.  An
inverted index is a data structure common to nearly all information
retrieval systems.  Let us consider the following famous lines from
Shakespeare's <i>Merchants of Venice</i>:</p>

<pre>
1: if you prick us do we not bleed
2: if you tickle us do we not laugh 
3: if you poison us do we not die and 
4: if you wrong us shall we not revenge
</pre>

<p>An inverted index consists of a collection of postings lists, one
associated with each unique term in the collection.  Each postings
list consists of a number of individual postings.  Each posting holds
a document identifier and the frequency (i.e., count) of the term in that
document.</p>

<p>Let's treat each line in the above sample data as if it were a
"document".  The complete inverted index would look like:</p>

<pre>
and     : 1 : (3, 1)
bleed   : 1 : (1, 1)
die     : 1 : (3, 1)
do      : 3 : (1, 1), (2, 1), (3, 1)
if      : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
laugh   : 1 : (2, 1)
not     : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
poison  : 1 : (3, 1)
prick   : 1 : (1, 1)
revenge : 1 : (4, 1)
shall   : 1 : (4, 1)
tickle  : 1 : (2, 1)
us      : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
we      : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
wrong   : 1 : (4, 1)
you     : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
</pre>

<p>As you can see, we have a postings list for each word that appears
in the collection.  Let us look at the postings list corresponding to
the term <i>if</i> in a bit more detail:</p>

<pre>
if      : 4 : (1, 1), (2, 1), (3, 1), (4, 1)
</pre>

<p>The number directly after the term is its <i>document frequency</i>
or <i>df</i> for short.  The <i>df</i> specifies the number of
documents that contain this term.  Since <i>if</i> appears in all four
documents, its <i>df</i> is 4.  Although the <i>df</i> can be easily
reconstructed by counting the number of postings, it is often
explicitly stored in the inverted index.  The postings list contains a
number of postings, each of which is a (<i>docno</i>, <i>tf</i>)
tuple.  The <i>docno</i> is simply a unique identifier for the
document (one through four, in this case).  The <i>tf</i>, which
stands for <i>term frequency</i>, is the number of times the term
appears in the document.  The term <i>if</i> appears once in every
document.</p>

<p><b>Your task:</b> write a MapReduce program that builds an inverted
index.  You can choose to store the <i>df</i> explicitly if you wish,
but that's optional.  Your postings, however, should be exactly as
described above.</p>

<p>Run the inverted indexer on the sample input included in
Cloud<sup><small>9</small></sup>, <a href="../../sample-input/bible+shakes.nopunc">the
Bible and the complete works of Shakespeare</a>.  As with the above
case, treat each line as if it were an individual "document".  When
you map over a plain text file, the key passed to the mapper contains
the byte offset of the line from the beginning of the file, while the
value contains the text of the line.  Use this offset value as the
unique docno.  As part of this exercise you'll also need to write a
utility that takes a given docno (i.e., the byte offset) and returns
the associated line.</p>

<p>Questions to answer:</p>

<ol>

  <li>Look up the postings corresponding to the term "starcross'd".
  There should only be one line in the entire collection that contains
  the term.  What is that line?  What's its docno (byte offset)?</li>

  <li>Look up the postings corresponding to the term "gold".  Generate
  a histogram of <i>tf</i> values.  That is, in how many lines does
  "gold" appear once, twice, three times, etc.?</li>

  <li>Do the same for the terms "silver" and "bronze".</li>

</ol>




<p style="padding-top: 25px"><a href="../index.html">Back to main page</a></p>

</div>

<table width="100%" border="0" cellpadding="0" cellspacing="0" style="padding-top: 10px;">
<tr><td valign="top" align="left">
</td>
<td valign="top" align="right">
  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/us/">
  <img src="../images/creative-commons.png" border="0" alt="Creative Commons: Attribution-Noncommercial-Share Alike 3.0 United States"/>
  </a>
  <a href="http://validator.w3.org/check/referer">
  <img src="../images/valid-xhtml10.gif" border="0"
       alt="Valid XHTML 1.0!" height="31" width="88" />
  </a>
  <a href="http://jigsaw.w3.org/css-validator/check/referer">
  <img style="border:0;width:88px;height:31px"
       src="../images/vcss.gif" 
       alt="Valid CSS!" />
  </a>
</td></tr></table>

</td></tr></tbody></table></center>

</body></html>
